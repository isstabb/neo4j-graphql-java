:toc:

= Cypher DateTime

== Source schema

[source,graphql,schema=true]
----
type Movie {
  id: ID
  datetime: DateTime
}
----

== Configuration

.Configuration
[source,json,schema-config=true]
----
{
  "enableRegex": true
}
----
== Simple Create

.GraphQL-Query
[source,graphql]
----
mutation {
  createMovies(input: [{datetime: "1970-01-01T00:00:00.000Z"}]) {
    movies {
      datetime
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "this0_datetime": {
    "year": 1970,
    "month": 1,
    "day": 1,
    "hour": 0,
    "minute": 0,
    "second": 0,
    "nanosecond": 0,
    "timeZoneOffsetSeconds": 0
  }
}
----

.Expected Cypher output
[source,cypher]
----
CALL {
CREATE (this0:Movie)
SET this0.datetime = $this0_datetime
RETURN this0
}
RETURN 
this0 { datetime: apoc.date.convertFormat(toString(this0.datetime), "iso_zoned_date_time", "iso_offset_date_time") } AS this0
----

'''

== Simple Read

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {datetime: "1970-01-01T00:00:00.000Z"}) {
    datetime
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "this_datetime": {
    "year": 1970,
    "month": 1,
    "day": 1,
    "hour": 0,
    "minute": 0,
    "second": 0,
    "nanosecond": 0,
    "timeZoneOffsetSeconds": 0
  }
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.datetime = $this_datetime
RETURN this { datetime: apoc.date.convertFormat(toString(this.datetime), "iso_zoned_date_time", "iso_offset_date_time") } as this
----

'''

== Simple Update

.GraphQL-Query
[source,graphql]
----
mutation {
  updateMovies(update: {datetime: "1970-01-01T00:00:00.000Z"}) {
    movies {
      id
      datetime
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "this_update_datetime": {
    "year": 1970,
    "month": 1,
    "day": 1,
    "hour": 0,
    "minute": 0,
    "second": 0,
    "nanosecond": 0,
    "timeZoneOffsetSeconds": 0
  }
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)

SET this.datetime = $this_update_datetime

RETURN this { .id, datetime: apoc.date.convertFormat(toString(this.datetime), "iso_zoned_date_time", "iso_offset_date_time") } AS this
----

'''

