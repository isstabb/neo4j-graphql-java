:toc:

= Cypher Alias

== Source schema

[source,graphql,schema=true]
----
type Actor {
  name: String!
}

type Movie {
  id: ID
  releaseDate: DateTime!
  location: Point!
  actors: [Actor!]! @relationship(type: "ACTED_IN", direction: IN)
  custom: [Movie!]! @cypher(statement: """
  MATCH (m:Movie)
  RETURN m
  """)
}
----

== Configuration

.Configuration
[source,json,schema-config=true]
----
{
  "enableRegex": true
}
----
== Alias

.GraphQL-Query
[source,graphql]
----
{
  movies {
    movieId: id
    actors {
      aliasActorsName: name
    }
    custom {
      aliasCustomId: id
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "auth": {
    "isAuthenticated": true,
    "roles": [],
    "jwt": {
      "roles": []
    }
  }
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:`Movie`)

CALL {
    WITH this
    MATCH (this_actors:`Actor`)-[this0:ACTED_IN]->(this)
    WITH this_actors { aliasActorsName: this_actors.name } AS this_actors
    RETURN collect(this_actors) AS this_actors
}
CALL {
    WITH this
    UNWIND apoc.cypher.runFirstColumnMany("MATCH (m:Movie)
    RETURN m", { this: this, auth: $auth }) AS this_custom
    RETURN collect(this_custom { aliasCustomId: this_custom.id }) AS this_custom
}
RETURN this { movieId: this.id, actors: this_actors, custom: this_custom } AS this
----

'''

